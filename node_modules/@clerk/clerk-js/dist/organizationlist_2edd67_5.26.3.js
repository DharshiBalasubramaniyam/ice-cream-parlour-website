"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([[578],{8382:function(e,i,t){t.r(i),t.d(i,{OrganizationList:function(){return K}});var n=t(4380),a=t(844),o=t(9333),r=t(166),s=t(3931),l=t(4041),c=t(338),d=t(5909),u=t(8313),g=t(2916),h=t(3965);const p=e=>(0,n.Y)(o.Col,{elementDescriptor:o.descriptors.organizationListPreviewItems,sx:e=>({maxHeight:`calc(8 * ${e.sizes.$12})`,overflowY:"auto",borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100,...h.common.unstyledScrollbar(e)}),children:e.children}),v=e=>({padding:`${e.space.$4} ${e.space.$5}`}),z=e=>({color:e.colors.$colorText,":hover":{color:e.colors.$colorText}}),m=e=>(0,n.FD)(o.Flex,{align:"center",gap:2,sx:[e=>({minHeight:"unset",justifyContent:"space-between",borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100}),v],elementDescriptor:o.descriptors.organizationListPreviewItem,children:[(0,n.Y)(c.OrganizationPreview,{elementId:"organizationList",mainIdentifierSx:z,organization:e.organizationData}),e.children]}),C=(0,l.forwardRef)(((e,i)=>(0,n.Y)(o.Box,{ref:i,sx:e=>({width:"100%",height:e.space.$12,position:"relative"}),children:(0,n.Y)(o.Box,{sx:{margin:"auto",position:"absolute",left:"50%",top:"50%",transform:"translateY(-50%) translateX(-50%)"},children:(0,n.Y)(o.Spinner,{size:"sm",colorScheme:"primary",elementDescriptor:o.descriptors.spinner})})}))),S=e=>(0,n.Y)(o.Button,{elementDescriptor:o.descriptors.organizationListPreviewItemActionButton,textVariant:"buttonSmall",variant:"outline",size:"xs",...e}),Y=e=>(0,n.Y)(c.PreviewButton,{elementDescriptor:o.descriptors.organizationListPreviewButton,sx:[v],icon:u.yO,...e});var $=t(9927),x=t(4683),b=t(9513);const L=(0,c.withCardStateProvider)((e=>{const i=(0,c.useCardState)(),{navigateAfterSelectOrganization:t}=(0,a.useOrganizationListContext)(),{isLoaded:o,setActive:r}=(0,s.D_)();return o?(0,n.Y)(Y,{onClick:()=>{return n=e.organization,i.runAsync((async()=>{await r({organization:n}),await t(n)}));var n},children:(0,n.Y)(c.OrganizationPreview,{elementId:"organizationList",mainIdentifierSx:z,organization:e.organization})}):null})),y=(0,c.withCardStateProvider)((()=>{const e=(0,c.useCardState)(),{hidePersonal:i,navigateAfterSelectPersonal:t}=(0,a.useOrganizationListContext)(),{isLoaded:o,setActive:r}=(0,s.D_)(),{user:l}=(0,s.Jd)();if(!l)return null;const{username:d,primaryEmailAddress:u,primaryPhoneNumber:g,...h}=l;return i?null:(0,n.Y)(Y,{onClick:()=>{if(o)return e.runAsync((async()=>{await r({organization:null}),await t(l)}))},children:(0,n.Y)(c.PersonalWorkspacePreview,{user:h,mainIdentifierSx:z,title:(0,b.GQ)("organizationSwitcher.personalWorkspace")})})})),w={userMemberships:{infinite:!0},userInvitations:{infinite:!0},userSuggestions:{infinite:!0,status:["pending","accepted"]}},f=e=>{const i=(0,c.useCardState)();return(0,n.Y)(S,{isLoading:i.isLoading,onClick:e.onAccept,localizationKey:(0,o.localizationKeys)("organizationList.action__invitationAccept")})},P=(0,c.withCardStateProvider)((e=>{const i=(0,c.useCardState)(),{getOrganization:t}=(0,s.ho)(),[a,o]=(0,l.useState)(null),{userInvitations:r}=(0,s.D_)({userInvitations:w.userInvitations,userMemberships:w.userMemberships});return a?(0,n.Y)(L,{organization:a}):(0,n.Y)(m,{organizationData:e.publicOrganizationData,children:(0,n.Y)(f,{onAccept:()=>i.runAsync((async()=>[await e.accept(),await t(e.publicOrganizationData.id)])).then((([e,i])=>{var t;null===(t=null==r?void 0:r.setData)||void 0===t||t.call(r,(i=>(0,x.l_)(e,i,"negative"))),o(i)})).catch((e=>(0,$.H4)(e,[],i.setError)))})})})),D=e=>{const i=(0,c.useCardState)(),{userSuggestions:t}=(0,s.D_)({userSuggestions:w.userSuggestions});return"accepted"===e.status?(0,n.Y)(o.Text,{colorScheme:"secondary",localizationKey:(0,o.localizationKeys)("organizationList.suggestionsAcceptedLabel")}):(0,n.Y)(S,{isLoading:i.isLoading,onClick:()=>i.runAsync(e.accept).then((e=>{var i;return null===(i=null==t?void 0:t.setData)||void 0===i?void 0:i.call(t,(i=>(0,x.l_)(e,i)))})).catch((e=>(0,$.H4)(e,[],i.setError))),localizationKey:(0,o.localizationKeys)("organizationList.action__suggestionsAccept")})},A=(0,c.withCardStateProvider)((e=>(0,n.Y)(m,{organizationData:e.publicOrganizationData,children:(0,n.Y)(D,{...e})}))),O=()=>{const{userMemberships:e,userInvitations:i,userSuggestions:t}=(0,s.D_)(w),{ref:n}=(0,d.Wx)({threshold:0,onChange:n=>{var a,o,r;n&&(e.hasNextPage?null===(a=e.fetchNext)||void 0===a||a.call(e):i.hasNextPage?null===(o=i.fetchNext)||void 0===o||o.call(i):null===(r=t.fetchNext)||void 0===r||r.call(t))}});return{userMemberships:e,userInvitations:i,userSuggestions:t,ref:n}},k=({onCreateOrganizationClick:e})=>{const{user:i}=(0,s.Jd)();return(null==i?void 0:i.createOrganizationEnabled)?(0,n.Y)(c.Action,{elementDescriptor:o.descriptors.organizationListCreateOrganizationActionButton,icon:u.OM,label:(0,o.localizationKeys)("organizationList.action__createOrganization"),onClick:e,sx:e=>({borderTopWidth:e.borderWidths.$normal,borderTopStyle:e.borderStyles.$solid,borderTopColor:e.colors.$neutralAlpha100,padding:`${e.space.$5} ${e.space.$5}`}),iconSx:e=>({width:e.sizes.$9,height:e.sizes.$6})}):null},I=(0,c.withCardStateProvider)((()=>{const e=(0,c.useCardState)(),{userMemberships:i,userSuggestions:t,userInvitations:r}=O(),s=(null==i?void 0:i.isLoading)||(null==r?void 0:r.isLoading)||(null==t?void 0:t.isLoading),l=!!((null==i?void 0:i.count)||(null==r?void 0:r.count)||(null==t?void 0:t.count)),{hidePersonal:d}=(0,a.useOrganizationListContext)();return(0,n.FD)(c.Card.Root,{children:[(0,n.FD)(c.Card.Content,{sx:e=>({padding:`${e.space.$8} ${e.space.$none} ${e.space.$none}`}),children:[(0,n.Y)(c.Card.Alert,{sx:e=>({margin:`${e.space.$none} ${e.space.$5}`}),children:e.error}),s&&(0,n.Y)(o.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$60}),children:(0,n.Y)(o.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:o.descriptors.spinner})}),!s&&(0,n.Y)(_,{showListInitially:!(d&&!l)})]}),(0,n.Y)(c.Card.Footer,{})]})})),_=({showListInitially:e})=>{const{navigateAfterCreateOrganization:i,skipInvitationScreen:t,hideSlug:r}=(0,a.useOrganizationListContext)(),[s,c]=(0,l.useState)(!e);return(0,n.FD)(n.FK,{children:[!s&&(0,n.Y)(T,{onCreateOrganizationClick:()=>c(!0)}),s&&(0,n.Y)(o.Box,{sx:e=>({padding:`${e.space.$none} ${e.space.$5} ${e.space.$5}`}),children:(0,n.Y)(g.A,{flow:"organizationList",startPage:{headerTitle:(0,o.localizationKeys)("organizationList.createOrganization")},skipInvitationScreen:t,navigateAfterCreateOrganization:e=>i(e).then((()=>c(!1))),onCancel:e&&s?()=>c(!1):void 0,hideSlug:r})})]})},T=e=>{var i,t,r;const s=(0,a.useEnvironment)(),{ref:l,userMemberships:d,userSuggestions:u,userInvitations:g}=O(),{hidePersonal:h}=(0,a.useOrganizationListContext)(),v=(null==d?void 0:d.isLoading)||(null==g?void 0:g.isLoading)||(null==u?void 0:u.isLoading),z=(null==d?void 0:d.hasNextPage)||(null==g?void 0:g.hasNextPage)||(null==u?void 0:u.hasNextPage),m=null===(i=g.data)||void 0===i?void 0:i.filter((e=>!!e)),S=null===(t=u.data)||void 0===t?void 0:t.filter((e=>!!e));return(0,n.FD)(n.FK,{children:[(0,n.FD)(c.Header.Root,{sx:e=>({padding:`${e.space.$none} ${e.space.$8}`}),children:[(0,n.Y)(c.Header.Title,{localizationKey:(0,o.localizationKeys)(h?"organizationList.titleWithoutPersonal":"organizationList.title")}),(0,n.Y)(c.Header.Subtitle,{localizationKey:(0,o.localizationKeys)("organizationList.subtitle",{applicationName:s.displayConfig.applicationName})})]}),(0,n.Y)(o.Col,{elementDescriptor:o.descriptors.main,children:(0,n.Y)(p,{children:(0,n.FD)(c.Actions,{role:"menu",children:[(0,n.Y)(y,{}),(d.count||0)>0&&(null===(r=d.data)||void 0===r?void 0:r.map((e=>(0,n.Y)(L,{...e},e.id)))),!d.hasNextPage&&(null==m?void 0:m.map((e=>(0,n.Y)(P,{...e},e.id)))),!d.hasNextPage&&!g.hasNextPage&&(null==S?void 0:S.map((e=>(0,n.Y)(A,{...e},e.id)))),(z||v)&&(0,n.Y)(C,{ref:l}),(0,n.Y)(k,{onCreateOrganizationClick:()=>{e.onCreateOrganizationClick()}})]})})})]})},F=(0,a.withCoreUserGuard)(I),K=()=>(0,n.Y)(o.Flow.Root,{flow:"organizationList",children:(0,n.Y)(o.Flow.Part,{children:(0,n.Y)(r.Switch,{children:(0,n.Y)(r.Route,{children:(0,n.Y)(F,{})})})})})}}]);