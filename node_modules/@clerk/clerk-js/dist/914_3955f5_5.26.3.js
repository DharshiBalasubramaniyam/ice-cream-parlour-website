"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([[914],{4914:function(t,e,s){s.r(e),s.d(e,{Options:function(){return A},debounce:function(){return at},zxcvbn:function(){return ct},zxcvbnAsync:function(){return ht},zxcvbnOptions:function(){return C}});const n=(t,e)=>t.push.apply(t,e),r=t=>t.sort(((t,e)=>t.i-e.i||t.j-e.j)),a=t=>{const e={};let s=1;return t.forEach((t=>{e[t]=s,s+=1})),e},i={4:[[1,2],[2,3]],5:[[1,3],[2,3],[2,4]],6:[[1,2],[2,4],[4,5]],7:[[1,3],[2,3],[4,5],[4,6]],8:[[2,4],[4,6]]},o=/^[A-Z\xbf-\xdf][^A-Z\xbf-\xdf]+$/,l=/^[^A-Z\xbf-\xdf]+[A-Z\xbf-\xdf]$/,c=/^[A-Z\xbf-\xdf]+$/,h=/^[^a-z\xdf-\xff]+$/,u=/^[a-z\xdf-\xff]+$/,d=/^[^A-Z\xbf-\xdf]+$/,g=/[a-z\xdf-\xff]/,p=/[A-Z\xbf-\xdf]/,f=/[^A-Za-z\xbf-\xdf]/gi,m=/^\d+$/,b=(new Date).getFullYear(),y={recentYear:/19\d\d|200\d|201\d|202\d/g},k=[" ",",",";",":","|","/","\\","_",".","-"],w=k.length;class x{match({password:t}){const e=[...this.getMatchesWithoutSeparator(t),...this.getMatchesWithSeparator(t)],s=this.filterNoise(e);return r(s)}getMatchesWithSeparator(t){const e=[],s=/^(\d{1,4})([\s/\\_.-])(\d{1,2})\2(\d{1,4})$/;for(let n=0;n<=Math.abs(t.length-6);n+=1)for(let r=n+5;r<=n+9&&!(r>=t.length);r+=1){const a=t.slice(n,+r+1||9e9),i=s.exec(a);if(null!=i){const t=this.mapIntegersToDayMonthYear([parseInt(i[1],10),parseInt(i[3],10),parseInt(i[4],10)]);null!=t&&e.push({pattern:"date",token:a,i:n,j:r,separator:i[2],year:t.year,month:t.month,day:t.day})}}return e}getMatchesWithoutSeparator(t){const e=[],s=/^\d{4,8}$/,n=t=>Math.abs(t.year-b);for(let r=0;r<=Math.abs(t.length-4);r+=1)for(let a=r+3;a<=r+7&&!(a>=t.length);a+=1){const o=t.slice(r,+a+1||9e9);if(s.exec(o)){const t=[],s=o.length;if(i[s].forEach((([e,s])=>{const n=this.mapIntegersToDayMonthYear([parseInt(o.slice(0,e),10),parseInt(o.slice(e,s),10),parseInt(o.slice(s),10)]);null!=n&&t.push(n)})),t.length>0){let s=t[0],i=n(t[0]);t.slice(1).forEach((t=>{const e=n(t);e<i&&(s=t,i=e)})),e.push({pattern:"date",token:o,i:r,j:a,separator:"",year:s.year,month:s.month,day:s.day})}}}return e}filterNoise(t){return t.filter((e=>{let s=!1;const n=t.length;for(let r=0;r<n;r+=1){const n=t[r];if(e!==n&&n.i<=e.i&&n.j>=e.j){s=!0;break}}return!s}))}mapIntegersToDayMonthYear(t){if(t[1]>31||t[1]<=0)return null;let e=0,s=0,n=0;for(let r=0,a=t.length;r<a;r+=1){const a=t[r];if(a>99&&a<1e3||a>2050)return null;a>31&&(s+=1),a>12&&(e+=1),a<=0&&(n+=1)}return s>=2||3===e||n>=2?null:this.getDayMonth(t)}getDayMonth(t){const e=[[t[2],t.slice(0,2)],[t[0],t.slice(1,3)]],s=e.length;for(let n=0;n<s;n+=1){const[t,s]=e[n];if(1e3<=t&&t<=2050){const e=this.mapIntegersToDayMonth(s);return null!=e?{year:t,month:e.month,day:e.day}:null}}for(let n=0;n<s;n+=1){const[t,s]=e[n],r=this.mapIntegersToDayMonth(s);if(null!=r)return{year:this.twoToFourDigitYear(t),month:r.month,day:r.day}}return null}mapIntegersToDayMonth(t){const e=[t,t.slice().reverse()];for(let s=0;s<e.length;s+=1){const t=e[s],n=t[0],r=t[1];if(n>=1&&n<=31&&r>=1&&r<=12)return{day:n,month:r}}return null}twoToFourDigitYear(t){return t>99?t:t>50?t+1900:t+2e3}}const M=new Uint32Array(65536),S=(t,e,s)=>{let n=0;const r=Object.keys(e).find((e=>{const r=((t,e,s)=>{const n=t.length<=e.length,r=t.length<=s;return n||r?Math.ceil(t.length/4):s})(t,e,s);if(Math.abs(t.length-e.length)>r)return!1;const a=((t,e)=>{if(t.length<e.length){const s=e;e=t,t=s}return 0===e.length?t.length:t.length<=32?((t,e)=>{const s=t.length,n=e.length,r=1<<s-1;let a=-1,i=0,o=s,l=s;for(;l--;)M[t.charCodeAt(l)]|=1<<l;for(l=0;l<n;l++){let t=M[e.charCodeAt(l)];const s=t|i;t|=(t&a)+a^a,i|=~(t|a),a&=t,i&r&&o++,a&r&&o--,i=i<<1|1,a=a<<1|~(s|i),i&=s}for(l=s;l--;)M[t.charCodeAt(l)]=0;return o})(t,e):((t,e)=>{const s=e.length,n=t.length,r=[],a=[],i=Math.ceil(s/32),o=Math.ceil(n/32);for(let p=0;p<i;p++)a[p]=-1,r[p]=0;let l=0;for(;l<o-1;l++){let i=0,o=-1;const c=32*l,h=Math.min(32,n)+c;for(let e=c;e<h;e++)M[t.charCodeAt(e)]|=1<<e;for(let t=0;t<s;t++){const s=M[e.charCodeAt(t)],n=a[t/32|0]>>>t&1,l=r[t/32|0]>>>t&1,c=s|i,h=((s|l)&o)+o^o|s|l;let u=i|~(h|o),d=o&h;u>>>31^n&&(a[t/32|0]^=1<<t),d>>>31^l&&(r[t/32|0]^=1<<t),u=u<<1|n,d=d<<1|l,o=d|~(c|u),i=u&c}for(let e=c;e<h;e++)M[t.charCodeAt(e)]=0}let c=0,h=-1;const u=32*l,d=Math.min(32,n-u)+u;for(let p=u;p<d;p++)M[t.charCodeAt(p)]|=1<<p;let g=n;for(let p=0;p<s;p++){const t=M[e.charCodeAt(p)],s=a[p/32|0]>>>p&1,i=r[p/32|0]>>>p&1,o=t|c,l=((t|i)&h)+h^h|t|i;let u=c|~(l|h),d=h&l;g+=u>>>n-1&1,g-=d>>>n-1&1,u>>>31^s&&(a[p/32|0]^=1<<p),d>>>31^i&&(r[p/32|0]^=1<<p),u=u<<1|s,d=d<<1|i,h=d|~(o|u),c=u&o}for(let p=u;p<d;p++)M[t.charCodeAt(p)]=0;return g})(t,e)})(t,e),i=a<=r;return i&&(n=a),i}));return r?{levenshteinDistance:n,levenshteinDistanceEntry:r}:{}};var v={a:["4","@"],b:["8"],c:["(","{","[","<"],d:["6","|)"],e:["3"],f:["#"],g:["6","9","&"],h:["#","|-|"],i:["1","!","|"],k:["<","|<"],l:["!","1","|","7"],m:["^^","nn","2n","/\\\\/\\\\"],n:["//"],o:["0","()"],q:["9"],u:["|_|"],s:["$","5"],t:["+","7"],v:["<",">","/"],w:["^/","uu","vv","2u","2v","\\\\/\\\\/"],x:["%","><"],z:["2"]},T={warnings:{straightRow:"straightRow",keyPattern:"keyPattern",simpleRepeat:"simpleRepeat",extendedRepeat:"extendedRepeat",sequences:"sequences",recentYears:"recentYears",dates:"dates",topTen:"topTen",topHundred:"topHundred",common:"common",similarToCommon:"similarToCommon",wordByItself:"wordByItself",namesByThemselves:"namesByThemselves",commonNames:"commonNames",userInputs:"userInputs",pwned:"pwned"},suggestions:{l33t:"l33t",reverseWords:"reverseWords",allUppercase:"allUppercase",capitalization:"capitalization",dates:"dates",recentYears:"recentYears",associatedYears:"associatedYears",sequences:"sequences",repeated:"repeated",longerKeyboardPattern:"longerKeyboardPattern",anotherWord:"anotherWord",useWords:"useWords",noNeed:"noNeed",pwned:"pwned"},timeEstimation:{ltSecond:"ltSecond",second:"second",seconds:"seconds",minute:"minute",minutes:"minutes",hour:"hour",hours:"hours",day:"day",days:"days",month:"month",months:"months",year:"year",years:"years",centuries:"centuries"}};class j{constructor(t=[]){this.parents=t,this.children=new Map}addSub(t,...e){const s=t.charAt(0);this.children.has(s)||this.children.set(s,new j([...this.parents,s]));let n=this.children.get(s);for(let r=1;r<t.length;r+=1){const e=t.charAt(r);n.hasChild(e)||n.addChild(e),n=n.getChild(e)}return n.subs=(n.subs||[]).concat(e),this}getChild(t){return this.children.get(t)}isTerminal(){return!!this.subs}addChild(t){this.hasChild(t)||this.children.set(t,new j([...this.parents,t]))}hasChild(t){return this.children.has(t)}}var I=(t,e)=>(Object.entries(t).forEach((([t,s])=>{s.forEach((s=>{e.addSub(s,t)}))})),e);class A{constructor(){this.matchers={},this.l33tTable=v,this.trieNodeRoot=I(v,new j),this.dictionary={userInputs:[]},this.rankedDictionaries={},this.rankedDictionariesMaxWordSize={},this.translations=T,this.graphs={},this.useLevenshteinDistance=!1,this.levenshteinThreshold=2,this.l33tMaxSubstitutions=100,this.maxLength=256,this.setRankedDictionaries()}setOptions(t={}){t.l33tTable&&(this.l33tTable=t.l33tTable,this.trieNodeRoot=I(t.l33tTable,new j)),t.dictionary&&(this.dictionary=t.dictionary,this.setRankedDictionaries()),t.translations&&this.setTranslations(t.translations),t.graphs&&(this.graphs=t.graphs),void 0!==t.useLevenshteinDistance&&(this.useLevenshteinDistance=t.useLevenshteinDistance),void 0!==t.levenshteinThreshold&&(this.levenshteinThreshold=t.levenshteinThreshold),void 0!==t.l33tMaxSubstitutions&&(this.l33tMaxSubstitutions=t.l33tMaxSubstitutions),void 0!==t.maxLength&&(this.maxLength=t.maxLength)}setTranslations(t){if(!this.checkCustomTranslations(t))throw new Error("Invalid translations object fallback to keys");this.translations=t}checkCustomTranslations(t){let e=!0;return Object.keys(T).forEach((s=>{if(s in t){const n=s;Object.keys(T[n]).forEach((s=>{s in t[n]||(e=!1)}))}else e=!1})),e}setRankedDictionaries(){const t={},e={};Object.keys(this.dictionary).forEach((s=>{t[s]=a(this.dictionary[s]),e[s]=this.getRankedDictionariesMaxWordSize(this.dictionary[s])})),this.rankedDictionaries=t,this.rankedDictionariesMaxWordSize=e}getRankedDictionariesMaxWordSize(t){const e=t.map((t=>"string"!=typeof t?t.toString().length:t.length));return 0===e.length?0:e.reduce(((t,e)=>Math.max(t,e)),-1/0)}buildSanitizedRankedDictionary(t){const e=[];return t.forEach((t=>{const s=typeof t;"string"!==s&&"number"!==s&&"boolean"!==s||e.push(t.toString().toLowerCase())})),a(e)}extendUserInputsDictionary(t){this.dictionary.userInputs||(this.dictionary.userInputs=[]);const e=[...this.dictionary.userInputs,...t];this.rankedDictionaries.userInputs=this.buildSanitizedRankedDictionary(e),this.rankedDictionariesMaxWordSize.userInputs=this.getRankedDictionariesMaxWordSize(e)}addMatcher(t,e){this.matchers[t]?console.info(`Matcher ${t} already exists`):this.matchers[t]=e}}const C=new A;class D{constructor(t){this.defaultMatch=t}match({password:t}){const e=t.split("").reverse().join("");return this.defaultMatch({password:e}).map((e=>({...e,token:e.token.split("").reverse().join(""),reversed:!0,i:t.length-1-e.j,j:t.length-1-e.i})))}}class E{constructor({substr:t,limit:e,trieRoot:s}){this.buffer=[],this.finalPasswords=[],this.substr=t,this.limit=e,this.trieRoot=s}getAllPossibleSubsAtIndex(t){const e=[];let s=this.trieRoot;for(let n=t;n<this.substr.length;n+=1){const t=this.substr.charAt(n);if(s=s.getChild(t),!s)break;e.push(s)}return e}helper({onlyFullSub:t,isFullSub:e,index:s,subIndex:n,changes:r,lastSubLetter:a,consecutiveSubCount:i}){if(this.finalPasswords.length>=this.limit)return;if(s===this.substr.length)return void(t===e&&this.finalPasswords.push({password:this.buffer.join(""),changes:r}));const o=[...this.getAllPossibleSubsAtIndex(s)];let l=!1;for(let c=s+o.length-1;c>=s;c-=1){const h=o[c-s];if(h.isTerminal()){if(a===h.parents.join("")&&i>=3)continue;l=!0;const s=h.subs;for(const o of s){this.buffer.push(o);const s=r.concat({i:n,letter:o,substitution:h.parents.join("")});if(this.helper({onlyFullSub:t,isFullSub:e,index:c+1,subIndex:n+o.length,changes:s,lastSubLetter:h.parents.join(""),consecutiveSubCount:a===h.parents.join("")?i+1:1}),this.buffer.pop(),this.finalPasswords.length>=this.limit)return}}}if(!t||!l){const o=this.substr.charAt(s);this.buffer.push(o),this.helper({onlyFullSub:t,isFullSub:e&&!l,index:s+1,subIndex:n+1,changes:r,lastSubLetter:a,consecutiveSubCount:i}),this.buffer.pop()}}getAll(){return this.helper({onlyFullSub:!0,isFullSub:!0,index:0,subIndex:0,changes:[],lastSubLetter:void 0,consecutiveSubCount:0}),this.helper({onlyFullSub:!1,isFullSub:!0,index:0,subIndex:0,changes:[],lastSubLetter:void 0,consecutiveSubCount:0}),this.finalPasswords}}class L{constructor(t){this.defaultMatch=t}isAlreadyIncluded(t,e){return t.some((t=>Object.entries(t).every((([t,s])=>"subs"===t||s===e[t]))))}match({password:t}){const e=[],s=((t,e,s)=>new E({substr:t,limit:e,trieRoot:s}).getAll())(t,C.l33tMaxSubstitutions,C.trieNodeRoot);let n=!1,r=!0;return s.forEach((s=>{if(n)return;const a=this.defaultMatch({password:s.password,useLevenshtein:r});r=!1,a.forEach((r=>{n||(n=0===r.i&&r.j===t.length-1);const a=((t,e,s)=>{const n=t.changes.filter((t=>t.i<e)).reduce(((t,e)=>t-e.letter.length+e.substitution.length),e),r=t.changes.filter((t=>t.i>=e&&t.i<=s)),a=r.reduce(((t,e)=>t-e.letter.length+e.substitution.length),s-e+n),i=[],o=[];return r.forEach((t=>{i.findIndex((e=>e.letter===t.letter&&e.substitution===t.substitution))<0&&(i.push({letter:t.letter,substitution:t.substitution}),o.push(`${t.substitution} -> ${t.letter}`))})),{i:n,j:a,subs:i,subDisplay:o.join(", ")}})(s,r.i,r.j),i=t.slice(a.i,+a.j+1||9e9),o={...r,l33t:!0,token:i,...a},l=this.isAlreadyIncluded(e,o);i.toLowerCase()===r.matchedWord||l||e.push(o)}))})),e.filter((t=>t.token.length>1))}}class P{constructor(){this.l33t=new L(this.defaultMatch),this.reverse=new D(this.defaultMatch)}match({password:t}){const e=[...this.defaultMatch({password:t}),...this.reverse.match({password:t}),...this.l33t.match({password:t})];return r(e)}defaultMatch({password:t,useLevenshtein:e=!0}){const s=[],n=t.length,r=t.toLowerCase();return Object.keys(C.rankedDictionaries).forEach((a=>{const i=C.rankedDictionaries[a],o=C.rankedDictionariesMaxWordSize[a],l=Math.min(o,n);for(let c=0;c<n;c+=1){const o=Math.min(c+l,n);for(let l=c;l<o;l+=1){const o=r.slice(c,+l+1||9e9),h=o in i;let u={};const d=0===c&&l===n-1;C.useLevenshteinDistance&&d&&!h&&e&&(u=S(o,i,C.levenshteinThreshold));const g=0!==Object.keys(u).length;if(h||g){const e=i[g?u.levenshteinDistanceEntry:o];s.push({pattern:"dictionary",i:c,j:l,token:t.slice(c,+l+1||9e9),matchedWord:o,rank:e,dictionaryName:a,reversed:!1,l33t:!1,...u})}}}})),s}}class R{match({password:t,regexes:e=y}){const s=[];return Object.keys(e).forEach((n=>{const r=e[n];let a;for(r.lastIndex=0;a=r.exec(t);)if(a){const t=a[0];s.push({pattern:"regex",token:t,i:a.index,j:a.index+a[0].length-1,regexName:n,regexMatch:a})}})),r(s)}}var O={nCk(t,e){let s=t;if(e>s)return 0;if(0===e)return 1;let n=1;for(let r=1;r<=e;r+=1)n*=s,n/=r,s-=1;return n},log10(t){return 0===t?0:Math.log(t)/Math.log(10)},log2(t){return Math.log(t)/Math.log(2)},factorial(t){let e=1;for(let s=2;s<=t;s+=1)e*=s;return e}};const N=(t,e)=>{let s=0,n=t.indexOf(e);for(;n>=0;)s+=1,n=t.indexOf(e,n+e.length);return s};const z={bruteforce:({token:t})=>{let e,s=10**t.length;return s===Number.POSITIVE_INFINITY&&(s=Number.MAX_VALUE),e=1===t.length?11:51,Math.max(s,e)},date:({year:t,separator:e})=>{let s=365*Math.max(Math.abs(t-b),20);return e&&(s*=4),s},dictionary:({rank:t,reversed:e,l33t:s,subs:n,token:r,dictionaryName:a})=>{const i=t,c=(t=>{const e=t.replace(f,"");if(e.match(d)||e.toLowerCase()===e)return 1;const s=[o,l,h],n=s.length;for(let r=0;r<n;r+=1){const t=s[r];if(e.match(t))return 2}return(t=>{const e=t.split(""),s=e.filter((t=>t.match(p))).length,n=e.filter((t=>t.match(g))).length;let r=0;const a=Math.min(s,n);for(let i=1;i<=a;i+=1)r+=O.nCk(s+n,i);return r})(e)})(r),u=(({l33t:t,subs:e,token:s})=>{if(!t)return 1;let n=1;return e.forEach((t=>{const{subbedCount:e,unsubbedCount:r}=(({sub:t,token:e})=>{const s=e.toLowerCase();return{subbedCount:N(s,t.substitution),unsubbedCount:N(s,t.letter)}})({sub:t,token:s});if(0===e||0===r)n*=2;else{const t=Math.min(r,e);let s=0;for(let n=1;n<=t;n+=1)s+=O.nCk(r+e,n);n*=s}})),n})({l33t:s,subs:n,token:r});let m;return m="diceware"===a?3888:i*c*u*(e?2:1),{baseGuesses:i,uppercaseVariations:c,l33tVariations:u,calculation:m}},regex:({regexName:t,regexMatch:e,token:s})=>{const n={alphaLower:26,alphaUpper:26,alpha:52,alphanumeric:62,digits:10,symbols:33};return t in n?n[t]**s.length:"recentYear"===t?Math.max(Math.abs(parseInt(e[0],10)-b),20):0},repeat:({baseGuesses:t,repeatCount:e})=>t*e,sequence:({token:t,ascending:e})=>{const s=t.charAt(0);let n=0;return n=["a","A","z","Z","0","1","9"].includes(s)?4:s.match(/\d/)?10:26,e||(n*=2),n*t.length},spatial:({graph:t,token:e,shiftedCount:s,turns:n})=>{let r=(({token:t,graph:e,turns:s})=>{const n=Object.keys(C.graphs[e]).length,r=(t=>{let e=0;return Object.keys(t).forEach((s=>{const n=t[s];e+=n.filter((t=>!!t)).length})),e/=Object.entries(t).length,e})(C.graphs[e]);let a=0;const i=t.length;for(let o=2;o<=i;o+=1){const t=Math.min(s,o-1);for(let e=1;e<=t;e+=1)a+=O.nCk(o-1,e-1)*n*r**e}return a})({token:e,graph:t,turns:n});if(s){const t=e.length-s;if(0===s||0===t)r*=2;else{let e=0;for(let n=1;n<=Math.min(s,t);n+=1)e+=O.nCk(s+t,n);r*=e}}return Math.round(r)},separator:()=>w};const F={password:"",optimal:{},excludeAdditive:!1,separatorRegex:void 0,fillArray(t,e){const s=[];for(let n=0;n<t;n+=1){let t=[];"object"===e&&(t={}),s.push(t)}return s},makeBruteforceMatch(t,e){return{pattern:"bruteforce",token:this.password.slice(t,+e+1||9e9),i:t,j:e}},update(t,e){const s=t.j,n=((t,e)=>{const s={};if("guesses"in t&&null!=t.guesses)return t;const n=((t,e)=>{let s=1;return t.token.length<e.length&&(s=1===t.token.length?10:50),s})(t,e),r=((t,e)=>z[t]?z[t](e):C.matchers[t]&&"scoring"in C.matchers[t]?C.matchers[t].scoring(e):0)(t.pattern,t);let a=0;"number"==typeof r?a=r:"dictionary"===t.pattern&&(a=r.calculation,s.baseGuesses=r.baseGuesses,s.uppercaseVariations=r.uppercaseVariations,s.l33tVariations=r.l33tVariations);const i=Math.max(a,n);return{...t,...s,guesses:i,guessesLog10:O.log10(i)}})(t,this.password);let r=n.guesses;e>1&&(r*=this.optimal.pi[n.i-1][e-1]);let a=O.factorial(e)*r;this.excludeAdditive||(a+=1e4**(e-1));let i=!1;Object.keys(this.optimal.g[s]).forEach((t=>{const n=this.optimal.g[s][t];parseInt(t,10)<=e&&n<=a&&(i=!0)})),i||(this.optimal.g[s][e]=a,this.optimal.m[s][e]=n,this.optimal.pi[s][e]=r)},bruteforceUpdate(t){let e=this.makeBruteforceMatch(0,t);this.update(e,1);for(let s=1;s<=t;s+=1){e=this.makeBruteforceMatch(s,t);const n=this.optimal.m[s-1];Object.keys(n).forEach((t=>{"bruteforce"!==n[t].pattern&&this.update(e,parseInt(t,10)+1)}))}},unwind(t){const e=[];let s=t-1,n=0,r=Infinity;const a=this.optimal.g[s];for(a&&Object.keys(a).forEach((t=>{const e=a[t];e<r&&(n=parseInt(t,10),r=e)}));s>=0;){const t=this.optimal.m[s][n];e.unshift(t),s=t.i-1,n-=1}return e}};var q={mostGuessableMatchSequence(t,e,s=!1){F.password=t,F.excludeAdditive=s;const n=t.length;let r=F.fillArray(n,"array");e.forEach((t=>{r[t.j].push(t)})),r=r.map((t=>t.sort(((t,e)=>t.i-e.i)))),F.optimal={m:F.fillArray(n,"object"),pi:F.fillArray(n,"object"),g:F.fillArray(n,"object")};for(let l=0;l<n;l+=1)r[l].forEach((t=>{t.i>0?Object.keys(F.optimal.m[t.i-1]).forEach((e=>{F.update(t,parseInt(e,10)+1)})):F.update(t,1)})),F.bruteforceUpdate(l);const a=F.unwind(n),i=a.length,o=this.getGuesses(t,i);return{password:t,guesses:o,guessesLog10:O.log10(o),sequence:a}},getGuesses(t,e){const s=t.length;let n=0;return n=0===t.length?1:F.optimal.g[s-1][e],n}};class W{match({password:t,omniMatch:e}){const s=[];let n=0;for(;n<t.length;){const r=this.getGreedyMatch(t,n),a=this.getLazyMatch(t,n);if(null==r)break;const{match:i,baseToken:o}=this.setMatchToken(r,a);if(i){const t=i.index+i[0].length-1,r=this.getBaseGuesses(o,e);s.push(this.normalizeMatch(o,t,i,r)),n=t+1}}return s.some((t=>t instanceof Promise))?Promise.all(s):s}normalizeMatch(t,e,s,n){const r={pattern:"repeat",i:s.index,j:e,token:s[0],baseToken:t,baseGuesses:0,repeatCount:s[0].length/t.length};return n instanceof Promise?n.then((t=>({...r,baseGuesses:t}))):{...r,baseGuesses:n}}getGreedyMatch(t,e){const s=/(.+)\1+/g;return s.lastIndex=e,s.exec(t)}getLazyMatch(t,e){const s=/(.+?)\1+/g;return s.lastIndex=e,s.exec(t)}setMatchToken(t,e){const s=/^(.+?)\1+$/;let n,r="";if(e&&t[0].length>e[0].length){n=t;const e=s.exec(n[0]);e&&(r=e[1])}else n=e,n&&(r=n[1]);return{match:n,baseToken:r}}getBaseGuesses(t,e){const s=e.match(t);return s instanceof Promise?s.then((e=>q.mostGuessableMatchSequence(t,e).guesses)):q.mostGuessableMatchSequence(t,s).guesses}}class Y{constructor(){this.MAX_DELTA=5}match({password:t}){const e=[];if(1===t.length)return[];let s=0,n=null;const r=t.length;for(let a=1;a<r;a+=1){const r=t.charCodeAt(a)-t.charCodeAt(a-1);if(null==n&&(n=r),r!==n){const i=a-1;this.update({i:s,j:i,delta:n,password:t,result:e}),s=i,n=r}}return this.update({i:s,j:r-1,delta:n,password:t,result:e}),e}update({i:t,j:e,delta:s,password:n,result:r}){if(e-t>1||1===Math.abs(s)){const a=Math.abs(s);if(a>0&&a<=this.MAX_DELTA){const a=n.slice(t,+e+1||9e9),{sequenceName:i,sequenceSpace:o}=this.getSequence(a);return r.push({pattern:"sequence",i:t,j:e,token:n.slice(t,+e+1||9e9),sequenceName:i,sequenceSpace:o,ascending:s>0})}}return null}getSequence(t){let e="unicode",s=26;return u.test(t)?(e="lower",s=26):c.test(t)?(e="upper",s=26):m.test(t)&&(e="digits",s=10),{sequenceName:e,sequenceSpace:s}}}class ${constructor(){this.SHIFTED_RX=/[~!@#$%^&*()_+QWERTYUIOP{}|ASDFGHJKL:"ZXCVBNM<>?]/}match({password:t}){const e=[];return Object.keys(C.graphs).forEach((s=>{const r=C.graphs[s];n(e,this.helper(t,r,s))})),r(e)}checkIfShifted(t,e,s){return!t.includes("keypad")&&this.SHIFTED_RX.test(e.charAt(s))?1:0}helper(t,e,s){let n;const r=[];let a=0;const i=t.length;for(;a<i-1;){let o=a+1,l=null,c=0;for(n=this.checkIfShifted(s,t,a);;){const h=e[t.charAt(o-1)]||[];let u=!1,d=-1,g=-1;if(o<i){const e=t.charAt(o),s=h.length;for(let t=0;t<s;t+=1){const s=h[t];if(g+=1,s){const t=s.indexOf(e);if(-1!==t){u=!0,d=g,1===t&&(n+=1),l!==d&&(c+=1,l=d);break}}}}if(!u){o-a>2&&r.push({pattern:"spatial",i:a,j:o-1,token:t.slice(a,o),graph:s,turns:c,shiftedCount:n}),a=o;break}o+=1}}return r}}const G=new RegExp(`[${k.join("")}]`);class _{static getMostUsedSeparatorChar(t){const e=[...t.split("").filter((t=>G.test(t))).reduce(((t,e)=>{const s=t.get(e);return s?t.set(e,s+1):t.set(e,1),t}),new Map).entries()].sort((([t,e],[s,n])=>n-e));if(!e.length)return;const s=e[0];return s[1]<2?void 0:s[0]}static getSeparatorRegex(t){return new RegExp(`([^${t}\n])(${t})(?!${t})`,"g")}match({password:t}){const e=[];if(0===t.length)return e;const s=_.getMostUsedSeparatorChar(t);if(void 0===s)return e;const n=_.getSeparatorRegex(s);for(const r of t.matchAll(n)){if(void 0===r.index)continue;const t=r.index+1;e.push({pattern:"separator",token:s,i:t,j:t})}return e}}class U{constructor(){this.matchers={date:x,dictionary:P,regex:R,repeat:W,sequence:Y,spatial:$,separator:_}}match(t){const e=[],s=[];return[...Object.keys(this.matchers),...Object.keys(C.matchers)].forEach((r=>{if(!this.matchers[r]&&!C.matchers[r])return;const a=(new(this.matchers[r]?this.matchers[r]:C.matchers[r].Matching)).match({password:t,omniMatch:this});a instanceof Promise?(a.then((t=>{n(e,t)})),s.push(a)):n(e,a)})),s.length>0?new Promise(((t,n)=>{Promise.all(s).then((()=>{t(r(e))})).catch((t=>{n(t)}))})):r(e)}}const B=32140800,H={second:1,minute:60,hour:3600,day:86400,month:2678400,year:B,century:100*B};class Z{translate(t,e){let s=t;void 0!==e&&1!==e&&(s+="s");const{timeEstimation:n}=C.translations;return n[s].replace("{base}",`${e}`)}estimateAttackTimes(t){const e={onlineThrottling100PerHour:t/(100/3600),onlineNoThrottling10PerSecond:t/10,offlineSlowHashing1e4PerSecond:t/1e4,offlineFastHashing1e10PerSecond:t/1e10},s={onlineThrottling100PerHour:"",onlineNoThrottling10PerSecond:"",offlineSlowHashing1e4PerSecond:"",offlineFastHashing1e10PerSecond:""};return Object.keys(e).forEach((t=>{const n=e[t];s[t]=this.displayTime(n)})),{crackTimesSeconds:e,crackTimesDisplay:s,score:this.guessesToScore(t)}}guessesToScore(t){return t<1005?0:t<1000005?1:t<100000005?2:t<10000000005?3:4}displayTime(t){let e,s="centuries";const n=Object.keys(H),r=n.findIndex((e=>t<H[e]));return r>-1&&(s=n[r-1],0!==r?e=Math.round(t/H[s]):s="ltSecond"),this.translate(s,e)}}var V=()=>null,X=()=>({warning:C.translations.warnings.dates,suggestions:[C.translations.suggestions.dates]});var K=(t,e)=>{const s=((t,e)=>{let s=null;const n=t.dictionaryName,r="lastnames"===n||n.toLowerCase().includes("firstnames");return"passwords"===n?s=((t,e)=>{let s=null;return!e||t.l33t||t.reversed?t.guessesLog10<=4&&(s=C.translations.warnings.similarToCommon):s=t.rank<=10?C.translations.warnings.topTen:t.rank<=100?C.translations.warnings.topHundred:C.translations.warnings.common,s})(t,e):n.includes("wikipedia")?s=((t,e)=>{let s=null;return e&&(s=C.translations.warnings.wordByItself),s})(0,e):r?s=((t,e)=>e?C.translations.warnings.namesByThemselves:C.translations.warnings.commonNames)(0,e):"userInputs"===n&&(s=C.translations.warnings.userInputs),s})(t,e),n=[],r=t.token;return r.match(o)?n.push(C.translations.suggestions.capitalization):r.match(h)&&r.toLowerCase()!==r&&n.push(C.translations.suggestions.allUppercase),t.reversed&&t.token.length>=4&&n.push(C.translations.suggestions.reverseWords),t.l33t&&n.push(C.translations.suggestions.l33t),{warning:s,suggestions:n}},J=t=>"recentYear"===t.regexName?{warning:C.translations.warnings.recentYears,suggestions:[C.translations.suggestions.recentYears,C.translations.suggestions.associatedYears]}:{warning:null,suggestions:[]},Q=t=>{let e=C.translations.warnings.extendedRepeat;return 1===t.baseToken.length&&(e=C.translations.warnings.simpleRepeat),{warning:e,suggestions:[C.translations.suggestions.repeated]}},tt=()=>({warning:C.translations.warnings.sequences,suggestions:[C.translations.suggestions.sequences]}),et=t=>{let e=C.translations.warnings.keyPattern;return 1===t.turns&&(e=C.translations.warnings.straightRow),{warning:e,suggestions:[C.translations.suggestions.longerKeyboardPattern]}},st=()=>null;const nt={warning:null,suggestions:[]};class rt{constructor(){this.matchers={bruteforce:V,date:X,dictionary:K,regex:J,repeat:Q,sequence:tt,spatial:et,separator:st},this.defaultFeedback={warning:null,suggestions:[]},this.setDefaultSuggestions()}setDefaultSuggestions(){this.defaultFeedback.suggestions.push(C.translations.suggestions.useWords,C.translations.suggestions.noNeed)}getFeedback(t,e){if(0===e.length)return this.defaultFeedback;if(t>2)return nt;const s=C.translations.suggestions.anotherWord,n=this.getLongestMatch(e);let r=this.getMatchFeedback(n,1===e.length);return null!=r?r.suggestions.unshift(s):r={warning:null,suggestions:[s]},r}getLongestMatch(t){let e=t[0];return t.slice(1).forEach((t=>{t.token.length>e.token.length&&(e=t)})),e}getMatchFeedback(t,e){return this.matchers[t.pattern]?this.matchers[t.pattern](t,e):C.matchers[t.pattern]&&"feedback"in C.matchers[t.pattern]?C.matchers[t.pattern].feedback(t,e):nt}}var at=(t,e,s)=>{let n;return function(...r){const a=this,i=s&&!n;if(void 0!==n&&clearTimeout(n),n=setTimeout((()=>{n=void 0,s||t.apply(a,r)}),e),i)return t.apply(a,r)}};const it=()=>(new Date).getTime(),ot=(t,e,s)=>{const n=new rt,r=new Z,a=q.mostGuessableMatchSequence(e,t),i=it()-s,o=r.estimateAttackTimes(a.guesses);return{calcTime:i,...a,...o,feedback:n.getFeedback(o.score,a.sequence)}},lt=(t,e)=>(e&&C.extendUserInputsDictionary(e),(new U).match(t)),ct=(t,e)=>{const s=it(),n=lt(t,e);if(n instanceof Promise)throw new Error("You are using a Promised matcher, please use `zxcvbnAsync` for it.");return ot(n,t,s)},ht=async(t,e)=>{const s=t.substring(0,C.maxLength),n=it(),r=await lt(s,e);return ot(r,s,n)}}}]);